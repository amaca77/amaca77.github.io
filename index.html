<!DOCTYPE html>
<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <script type="text/javascript">
        function msToTime(s) {
        var ms = s % 1000;
        s = (s - ms) / 1000;
        var secs = s % 60;
        s = (s - secs) / 60;
        var mins = s % 60;
        
        return mins + ':' + secs + '.' + ms;
        }
    </script>

<body>

<h1>Heading 1</h1>


<script>

    function sortByColumn(a, colIndex){

        a.sort(sortFunction);

        function sortFunction(a, b) {
            if (a[colIndex] === b[colIndex]) {
                return 0;
            }
            else {
                return (a[colIndex] < b[colIndex]) ? -1 : 1;
            }
        }

        return a;
    }



    function exitsLap(arr, lap)
    {
        var j=0;
        for (j = 0; j < arr.length; j++) {
            if(arr[j]["piloto"] == lap["piloto"] && arr[j]["auto"] == lap["auto"])
                return j;
        }
        return -1;
    }


    var files = ["2020_9_18_23_38_PRACTICE" ,"2020_9_19_1_39_PRACTICE"];
    var i;
    var data;
    var resumen = [];
    var pos;

    for (i = 0; i < files.length; i++) {
        console.log( files[i] + ".json");
    
        jQuery.getJSON("json/"+ files[i] + ".json", function(json) {
            //console.log("1->" + json);
            data = json; // this will show the info it in firebug console
            pista = data["TrackName"];

            jQuery.each(data["Result"], function(index, item) {
                if(item["BestLap"] != 999999999)
                {
                    var lap = [];
                    lap["piloto"] = item["DriverName"];
                    lap["auto"] = item["CarModel"];
                    lap["tiempo"] = item["BestLap"];

                    if(resumen[pista] == undefined)
                    {
                        resumen[pista] = [];
                        resumen[pista].push(lap);
                    }
                    else
                    {
                        pos = exitsLap(resumen[pista], lap);
                        if (pos == -1)
                        {
                            resumen[pista].push(lap);
                        }
                        else
                        {
                            if (resumen[pista][pos]["piloto"]==lap["piloto"] 
                                && resumen[pista][pos]["auto"]==lap["auto"] 
                                && resumen[pista][pos]["tiempo"] > lap["tiempo"])

                                resumen[pista][pos] = lap;
                            else
                                console.log(lap["piloto"] + " | "+ lap["auto"]+ " | "+ lap["tiempo"]);
                        }
                        
                    }
                }
               
            });

            console.log(resumen);
            var sorted_a = sortByColumn(resumen[pista], "tiempo");
            console.log("sorted");
            console.log(sorted_a);


            //resumen["pista"] = data["TrackName"];

        });
    }

    for (i = 0; i < resumen.length; i++) {
    }
</script>

</body>
</html>